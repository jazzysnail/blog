<!DOCTYPE html>
<html>
  <head>
    <title>Leon's blog</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="//at.alicdn.com/t/font_bq7x8lbm8uk81tt9.css"/>
    <link rel="stylesheet" type="text/css" href="/index.css"/>
    <!--[if lt IE 10]>
      <script src="https://as.alipayobjects.com/g/component/??console-polyfill/0.2.2/index.js,es5-shim/4.5.7/es5-shim.min.js,es5-shim/4.5.7/es5-sham.min.js,html5shiv/3.7.2/html5shiv.min.js,media-match/2.0.2/media.match.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div id="react-content"><div class="layout" data-reactroot="" data-reactid="1" data-react-checksum="-317350776"><div class="paper" data-reactid="2"><header class="layout-header" data-reactid="3"><div class="header-content" data-reactid="4"><div class="title" data-reactid="5"><a href="/" data-reactid="6"><img class="logo" src="http://oaul0t4t1.bkt.clouddn.com/imgs/blog-logo.jpg" alt="logo" data-reactid="7"/></a></div><div class="nav" data-reactid="8"><ul data-reactid="9"><li class="to-home" data-reactid="10"><a href="/" data-reactid="11">Home</a></li><li class="" data-reactid="12"><span data-reactid="13">Journal</span></li><li class="hide-in-mobile" data-reactid="14"><span data-reactid="15">Artwork</span></li><li class="" data-reactid="16"><span data-reactid="17">JS</span></li><li class="hide-in-mobile" data-reactid="18"><a href="/about" data-reactid="19">About</a></li></ul></div><div class="header-bottom-line" data-reactid="20"></div></div></header><div class="layout-content" data-reactid="21"><div class="post-info" data-reactid="22"><span data-reactid="23"><i class="mineicon mineicon-clock" data-reactid="24"></i><time data-reactid="25">2017-11-28</time></span><span data-reactid="26"><i class="mineicon mineicon-sale" data-reactid="27"></i><span class="tags" data-reactid="28"><a href="/" data-reactid="29">JS</a></span></span></div><h1 data-reactid="30">ä½¿ç”¨ js å®ç°å¼•ç”¨ä¼ é€’</h1><div class="entry-content" data-reactid="31"><article data-reactid="32"><p data-reactid="33"><!-- react-text: 34 -->ä¸€ä¸ªæµ‹è¯•åŒäº‹è®©æˆ‘ç»™è§£é‡Šä¸ºä»€ä¹ˆ js ä¸­å‚æ•°ä¼ é€’æ˜¯å€¼ä¼ é€’ï¼Œè§£é‡Šå®Œä¹‹åï¼Œåå€’å¯¹å¼•ç”¨ä¼ é€’äº§ç”Ÿäº†å…´è¶£ã€‚<!-- /react-text --></p><p data-reactid="35"><!-- react-text: 36 -->æ‰€ä»¥æƒ³è¦å°è¯•ä½¿ç”¨ js å®ç°ä¸€ä¸‹å¼•ç”¨ä¼ é€’ï¼Œå½“ç„¶å¼€å¤´å…ˆå¸®åŠ© js å…¥é—¨åŒå­¦è§£é‡Šä¸ºä½• js å‚æ•°ä¼ é€’æ˜¯å€¼ä¼ é€’ã€‚åé¢å°†ä¼šä¸€ç‚¹ä¸€ç‚¹å®ç°ä¸€ä¸ªå¼•ç”¨ä¼ é€’ï¼Œæˆ–è€…è¯´åœ¨ä¸¤ä¸ªå˜é‡ä¹‹é—´å»ºç«‹å…·æœ‰ç ´åæ€§çš„å¼•ç”¨ã€‚<!-- /react-text --></p><p data-reactid="37"><br data-reactid="38"/></p><h2 data-reactid="39"><!-- react-text: 40 -->ä¸ºä»€ä¹ˆå‚æ•°ä¼ é€’æ˜¯å€¼ä¼ é€’<!-- /react-text --></h2><p data-reactid="41"><!-- react-text: 42 -->é¦–å…ˆæˆ‘ä»¬å…ˆå°†å‡½æ•°è°ƒç”¨æ—¶çš„ä¸€äº›å°åŠ¨ä½œåšåˆ†è§£ï¼š<!-- /react-text --></p><pre class="language-js" data-reactid="43"><code data-reactid="44"><span class="token keyword">function</span> setName <span class="token punctuation">(</span>_p<span class="token punctuation">,</span> _name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  _p<span class="token punctuation">.</span>name <span class="token operator">=</span> _name
  _p <span class="token operator">=</span> <span class="token keyword">null</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> p <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">}</span>
<span class="token function">setName</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token string">'leon'</span><span class="token punctuation">)</span>
p<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// => {name: 'leon'}</span>
<span class="token comment" spellcheck="true">// æ€è€ƒä¸ºä»€ä¹ˆ p æ²¡æœ‰å˜æˆ null ?</span>

<span class="token comment" spellcheck="true">/**
 * å…¶å®å‡½æ•°åœ¨è°ƒç”¨æ—¶å½¢å‚è½¬åŒ–ä¸ºå®å‚æ—¶å’Œä¸‹é¢è¿™æ ·æ˜¯ç­‰æ•ˆçš„
 */</span>
<span class="token keyword">let</span> _p<span class="token punctuation">,</span> _name<span class="token punctuation">;</span>
_p <span class="token operator">=</span> p<span class="token punctuation">;</span>
_name <span class="token operator">=</span> <span class="token string">'leon'</span><span class="token punctuation">;</span>
_p <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/**
 * åé¢å¯¹ _p è¿›è¡Œé‡æ–°èµ‹å€¼ä¹Ÿä»…ä»…æ”¹å˜çš„æ˜¯ setName å‡½æ•°æ‰§è¡Œç¯å¢ƒä¸­çš„å˜é‡ _p çš„å€¼è€Œå·²ï¼Œå¹¶ä¸ä¼šå½±å“çˆ¶çº§ç¯å¢ƒçš„ pã€‚
 * åˆ°è¿™é‡Œå…¶å®å·²ç»è§£é‡Šå®Œäº†ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯å–œæ¬¢å¤šé—®å‡ ä¸ªä¸ºä»€ä¹ˆï¼Œè‚¯å®šæœ‰äººä¹Ÿæƒ³è¿‡ä¸‹é¢è¿™ç§é—®é¢˜ã€‚
 */</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> b <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
a<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// => 0</span>
b<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// => 1</span>
<span class="token comment" spellcheck="true">/**
 * æ€è€ƒä¸ºä»€ä¹ˆ b çš„å€¼æ²¡æœ‰è¢«æ”¹å˜ï¼Œå¦‚æœæˆ‘æƒ³è®©ä»–ä»¬å®Œå…¨ç»‘å®šï¼ˆå¼•ç”¨ä¼ é€’ï¼‰åœ¨ä¸€èµ·è¯¥æ€ä¹ˆåŠï¼Ÿ
 * å°±åƒæ˜¯ä¸€ä¸ªäººçœŸæ­£æ‹¥æœ‰äº†ä¸¤ä¸ªåå­—ï¼Œè€Œä¸ä»…ä»…æ˜¯å¤åˆ¶ä¸€ä¸ªï¼ˆå€¼ä¼ é€’ï¼‰ï¼Œè™½ç„¶å¬èµ·æ¥çœ‹èµ·æ¥éƒ½å¾ˆå¥‡æ€ªã€‚
 */</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> b <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
a<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// => 0</span>
b<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// => 0</span></code></pre><p data-reactid="45"><!-- react-text: 46 -->ä¸‹é¢æˆ‘å°†ä½¿ç”¨ js ç€æ‰‹å®ç°ä¸€ä¸ªå¼•ç”¨ä¼ é€’ï¼Œå¦‚æœæ²¡æœ‰å…´è¶£å°±å¯ä»¥å…³æ‰äº†ï¼Œå› ä¸ºä½ å·²ç»çŸ¥é“äº†ï¼š<!-- /react-text --></p><blockquote data-reactid="47"><p data-reactid="48"><!-- react-text: 49 -->åœ¨ js ä¸­å‚æ•°ä¼ é€’å’Œèµ‹å€¼è¿ç®—éƒ½æ˜¯å€¼ä¼ é€’çš„<!-- /react-text --></p></blockquote><p data-reactid="50"><br data-reactid="51"/></p><h2 data-reactid="52"><!-- react-text: 53 -->ç€æ‰‹å®ç°å¼•ç”¨ä¼ é€’<!-- /react-text --></h2><p data-reactid="54"><!-- react-text: 55 -->ä¸‹é¢æ˜¯ä¸€äº›ç¯å¢ƒå‡†å¤‡å·¥ä½œï¼Œéœ€è¦ä¸€ç‚¹çš„ <!-- /react-text --><strong data-reactid="56"><!-- react-text: 57 -->ES<!-- /react-text --></strong><!-- react-text: 58 --> è§„èŒƒçš„åŸºç¡€ï¼Œä»¥åŠä¸€äº› ES6 çš„è¯­æ³•ã€‚å¦‚æœä¸ç†Ÿæ‚‰å…¶å®ä¹Ÿä¸å¦¨ç»§ç»­çœ‹ä¸‹å»ã€‚ğŸ˜<!-- /react-text --></p><p data-reactid="59"><br data-reactid="60"/><!-- react-text: 61 --> <!-- /react-text --></p><h3 data-reactid="62"><!-- react-text: 63 -->åˆ›å»ºè§„èŒƒç±»å‹çš„ç±»çš„å®šä¹‰<!-- /react-text --></h3><pre class="language-js" data-reactid="64"><code data-reactid="65"><span class="token comment" spellcheck="true">/**
 * ç”¨äºå®ä¾‹åŒ–ä¸€ä¸ªå¼•ç”¨è§„èŒƒç±»å‹
 * å¼•ç”¨è§„èŒƒç±»å‹å°†è¢«ç”¨æ¥æè¿°ä¸€ä¸ªæŠ½è±¡å¼•ç”¨å…³ç³»
 * ç”± nameã€discription å’Œ canReferenced ä¸‰éƒ¨åˆ†ç»„æˆ
 * 
 * @param  {String}  name           å¼•ç”¨è®°å½•åç§°
 * @param  {Any}     discription    å¼•ç”¨æè¿°
 * @param  {Boolean} canReferenced  æ˜¯å¦å¯ä»¥è¢«å¼•ç”¨ä¼ é€’,é»˜è®¤å¯ä»¥
 */</span>
<span class="token keyword">class</span> <span class="token class-name">Reference</span> <span class="token punctuation">{</span>
  constructor <span class="token punctuation">(</span>ro <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    discription<span class="token punctuation">:</span> undefined<span class="token punctuation">,</span>
    canReferenced<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> ro<span class="token punctuation">.</span>name
    <span class="token keyword">this</span><span class="token punctuation">.</span>canReferenced <span class="token operator">=</span> ro<span class="token punctuation">.</span>canReferenced <span class="token operator">===</span> undefined <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token punctuation">:</span> ro<span class="token punctuation">.</span>canReferenced
    <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token string">'[[seter]]'</span><span class="token punctuation">]</span><span class="token punctuation">(</span>ro<span class="token punctuation">.</span>discription<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment" spellcheck="true">/**
   * å†…éƒ¨æ–¹æ³•ï¼Œè®¾ç½®å¼•ç”¨æè¿°
   * @param  {Any}  disc  å¼•ç”¨æè¿°
   */</span>
  <span class="token string">'[[seter]]'</span> <span class="token punctuation">(</span>disc<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>disc <span class="token keyword">instanceof</span> <span class="token class-name">Reference</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>disc<span class="token punctuation">.</span>canReferenced<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      disc <span class="token operator">=</span> disc<span class="token punctuation">[</span><span class="token string">'[[geter]]'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>discription <span class="token keyword">instanceof</span> <span class="token class-name">Reference</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>discription<span class="token punctuation">[</span><span class="token string">'[[seter]]'</span><span class="token punctuation">]</span><span class="token punctuation">(</span>disc<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>discription <span class="token operator">=</span> disc
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment" spellcheck="true">/**
   * å†…éƒ¨æ–¹æ³•ï¼Œè·å–å¼•ç”¨æè¿°
   */</span>
  <span class="token string">'[[geter]]'</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>discription <span class="token keyword">instanceof</span> <span class="token class-name">Reference</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>discription<span class="token punctuation">[</span><span class="token string">'[[geter]]'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>discription
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * è·å¾—å¼•ç”¨è§„èŒƒç±»å‹çš„å€¼
 * @param {Reference} v
 * @param {Boolean}   d  å–å€æ ‡å¿—ï¼Œæ˜¯å¦è·å–åŸå§‹å¼•ç”¨ç±»å‹ï¼Œç”¨äºå®ç°å–å€ç¬¦â€˜&amp;â€™
 */</span>
<span class="token keyword">function</span> GetValue <span class="token punctuation">(</span>v<span class="token punctuation">,</span> d<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>v <span class="token keyword">instanceof</span> <span class="token class-name">Reference</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>d <span class="token operator">?</span> v <span class="token punctuation">:</span> v<span class="token punctuation">[</span><span class="token string">'[[geter]]'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'TypeError: v is not a reference'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> undefined
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * è®¾ç½®å¼•ç”¨è§„èŒƒç±»å‹çš„å€¼
 * @param {Reference} v
 */</span>
<span class="token keyword">function</span> PutValue <span class="token punctuation">(</span>v<span class="token punctuation">,</span> w<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>v <span class="token keyword">instanceof</span> <span class="token class-name">Reference</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> v<span class="token punctuation">[</span><span class="token string">'[[seter]]'</span><span class="token punctuation">]</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'TypeError: v is not a reference'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> undefined
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p data-reactid="66"><!-- react-text: 67 -->ä¸Šé¢åœ¨åˆ›å»ºå¼•ç”¨è§„èŒƒç±»å‹æ—¶å‡å»äº†åŸºå€¼ï¼ˆbaseï¼‰å’Œä¸¥æ ¼å¼•ç”¨æ ‡è¯†ï¼ˆstrict referenceï¼‰ï¼Œæ”¹ä¸ºå¼•ç”¨æè¿°ï¼ˆdiscriptionï¼‰ï¼Œå¢åŠ  <!-- /react-text --><code data-reactid="68"><!-- react-text: 69 -->canReferenced<!-- /react-text --></code><!-- react-text: 70 --> ä½œä¸ºæ˜¯å¦å¯è¢«å¼•ç”¨ä¼ é€’çš„æ ‡è¯†ã€‚å› ä¸ºä¸‹é¢çš„ä¾‹å­åªå•çº¯ä»¥èµ‹å€¼è¿ç®—ä½œä¸ºä¾‹å­ï¼ˆåŸºå€¼åœ¨ä½œä¸ºå¯¹è±¡å±æ€§åº”ç”¨æ—¶ä¼šç”¨åˆ°ï¼‰ï¼Œå¸Œæœ›èƒ½å¤Ÿç®€å•å¿«é€Ÿçš„åˆ›å»ºå‡ºå¼•ç”¨è§„èŒƒç±»å‹ã€‚<!-- /react-text --></p><p data-reactid="71"><!-- react-text: 72 -->ä¸‹é¢å¼€å§‹å®ç°ä¸€ä¸ªç®€å•çš„ç¯å¢ƒè®°å½•ç”¨æ¥å­˜æ”¾è¿™äº›å¼•ç”¨ã€‚<!-- /react-text --></p><p data-reactid="73"><br data-reactid="74"/></p><h3 data-reactid="75"><!-- react-text: 76 -->åˆ›å»ºç¯å¢ƒè®°å½•å¯¹è±¡<!-- /react-text --></h3><p data-reactid="77"><!-- react-text: 78 -->ç”±æ›¿æ¢äº§ç”Ÿå¼ï¼š<!-- /react-text --></p><blockquote data-reactid="79"><p data-reactid="80"><!-- react-text: 81 -->AssignmentExpression :<!-- /react-text --></p><p data-reactid="82"><!-- react-text: 83 -->LeftHandSideExpression = AssignmentExpression<!-- /react-text --></p></blockquote><p data-reactid="84"><!-- react-text: 85 -->æ‰€å¾—åˆ°è®°å½•é¡¹çš„æ‰€æœ‰å¯èƒ½çš„é›†åˆæˆ‘ä»¬å–åä¸º<!-- /react-text --><strong data-reactid="86"><!-- react-text: 87 -->å¼•ç”¨èŒƒç•´<!-- /react-text --></strong><!-- react-text: 88 -->ï¼ˆéšä¾¿å–å~~ï¼‰ï¼Œç”¨ä»¥ä¸‹å¯¹è±¡ Rc ï¼ˆreference categoryï¼‰ä½œä¸ºå®ä¾‹ã€‚<!-- /react-text --></p><pre class="language-js" data-reactid="89"><code data-reactid="90"><span class="token keyword">const</span> RcPrototype <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">/**
   * æ·»åŠ å¼•ç”¨è®°å½•é¡¹
   * @param  {String}  name           å¼•ç”¨è®°å½•åç§°ï¼Œå½“ä¸ºæ›´æ”¹æ—¶æ— æ•ˆ
   * @param  {Any}     discription    å¼•ç”¨æè¿°ï¼Œå®é™…çš„åº”ç”¨ä½“ï¼Œä¸€ä¸ªå¼•ç”¨å¯¹è±¡
   * @param  {Boolean} isNewReference å°è¯•å£°æ˜æ–°å˜é‡æ ‡å¿—
   * @return {String}                 è®°å½•é¡¹çš„ç´¢å¼•
   */</span>
  put <span class="token punctuation">(</span>name<span class="token punctuation">,</span> reference<span class="token punctuation">,</span> isNewReference<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token operator">===</span> reference<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>isNewReference<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Identifier '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>reference<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">' has already been declared`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token function">PutValue</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">GetValue</span><span class="token punctuation">(</span>reference<span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token keyword">return</span> i
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> reference
    <span class="token keyword">return</span> name
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment" spellcheck="true">/**
   * è·å¾—å¼•ç”¨è®°å½•é¡¹
   * @param  {String} name å¼•ç”¨è®°å½•åç§°
   * @return {Reference}   å¼•ç”¨è®°å½•
   */</span>
  <span class="token keyword">get</span> <span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token operator">===</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`TypeError: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> is not defined`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> Rc <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>RcPrototype<span class="token punctuation">)</span></code></pre><p data-reactid="91"><!-- react-text: 92 -->åˆ°è¿™é‡Œç¯å¢ƒå‡†å¤‡å°±å®Œæˆäº†ï¼Œä¸‹é¢æˆ‘ä»¬æ¥éªŒè¯æ˜¯å¦å¯ä»¥åšåˆ°å¼•ç”¨ä¼ é€’ã€‚<!-- /react-text --></p><p data-reactid="93"><br data-reactid="94"/></p><h3 data-reactid="95"><!-- react-text: 96 -->æµ‹è¯•è¿è¡Œ<!-- /react-text --></h3><blockquote data-reactid="97"><p data-reactid="98"><!-- react-text: 99 -->æ³¨é‡Šå†…å®¹ä¸º js è¯­æ³•ï¼Œç´§è·Ÿç€çš„æ˜¯é€šè¿‡è¯æ³•ã€è¯­æ³•è§£é‡Šå™¨è§£é‡Šåæ‰§è¡Œçš„å…·ä½“ä»£ç ã€‚<!-- /react-text --></p></blockquote><pre class="language-js" data-reactid="100"><code data-reactid="101"><span class="token comment" spellcheck="true">/**
 * åˆ†åˆ«å£°æ˜å¹¶åˆå§‹åŒ– p1, p2 ä¸¤ä¸ªå˜é‡
 * p1 å…è®¸è¢«å¼•ç”¨ä¼ é€’
 * p2 ä¸å…è®¸è¢«å¼•ç”¨ä¼ é€’
 */</span>

<span class="token comment" spellcheck="true">// let p1 = 1;</span>
Rc<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'c1'</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Reference</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'p1'</span><span class="token punctuation">,</span>
  discription<span class="token punctuation">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">// p1;</span>
<span class="token function">GetValue</span><span class="token punctuation">(</span>Rc<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'p1'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// => 1</span>

<span class="token comment" spellcheck="true">// let p2 = 2;</span>
Rc<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'c2'</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Reference</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'p2'</span><span class="token punctuation">,</span>
  discription<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  canReferenced<span class="token punctuation">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">// p2;</span>
<span class="token function">GetValue</span><span class="token punctuation">(</span>Rc<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'p2'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// => 2</span></code></pre><p data-reactid="102"><!-- react-text: 103 -->ä¸‹é¢å°†ä½¿ç”¨ä¸€ä¸ªçš„æ–°çš„è¯­æ³• <!-- /react-text --><code data-reactid="104"><!-- react-text: 105 -->&amp;IdentifierName<!-- /react-text --></code><!-- react-text: 106 --> æ¥è·å–å˜é‡çš„åŸå§‹å¼•ç”¨ç±»å‹ç±»ï¼Œä»–æ˜¯é€šè¿‡ <!-- /react-text --><code data-reactid="107"><!-- react-text: 108 -->GetValue<!-- /react-text --></code><!-- react-text: 109 --> çš„ç¬¬äºŒä¸ªå‚æ•°å®ç°çš„ã€‚<!-- /react-text --></p><pre class="language-js" data-reactid="110"><code data-reactid="111"><span class="token comment" spellcheck="true">/**
 * å£°æ˜ p3, p4 ä¸¤ä¸ªå˜é‡å¹¶åˆ†åˆ«å¼•ç”¨ p1, p2 è¿›è¡Œåˆå§‹èµ‹å€¼
 */</span>

<span class="token comment" spellcheck="true">// let p3 = &amp;p1;</span>
Rc<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'c3'</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Reference</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'p3'</span><span class="token punctuation">,</span>
  discription<span class="token punctuation">:</span> <span class="token function">GetValue</span><span class="token punctuation">(</span>Rc<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'p1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">// p3;</span>
<span class="token function">GetValue</span><span class="token punctuation">(</span>Rc<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'p3'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// => 1</span>

<span class="token comment" spellcheck="true">// let p4 = &amp;p2;</span>
Rc<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'c4'</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Reference</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'p4'</span><span class="token punctuation">,</span>
  discription<span class="token punctuation">:</span> <span class="token function">GetValue</span><span class="token punctuation">(</span>Rc<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'p2'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">// p4;</span>
<span class="token function">GetValue</span><span class="token punctuation">(</span>Rc<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'p4'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// => 2</span></code></pre><pre class="language-js" data-reactid="112"><code data-reactid="113"><span class="token comment" spellcheck="true">/**
 * å°è¯•æ”¹å˜ p3, p4 çš„å€¼ï¼Œæµ‹è¯•èƒ½å¦å½±å“åˆ° p1, p2
 */</span>

<span class="token comment" spellcheck="true">// p3 = 0;</span>
Rc<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'c5'</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Reference</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'p3'</span><span class="token punctuation">,</span>
  discription<span class="token punctuation">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">// p4 = 0;</span>
Rc<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'c6'</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Reference</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'p4'</span><span class="token punctuation">,</span>
  discription<span class="token punctuation">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">// p1;</span>
<span class="token function">GetValue</span><span class="token punctuation">(</span>Rc<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'p1'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// => 0</span>

<span class="token comment" spellcheck="true">// p2;</span>
<span class="token function">GetValue</span><span class="token punctuation">(</span>Rc<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'p2'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// => 2</span>

<span class="token comment" spellcheck="true">/**
 * æœ€ç»ˆå°è¯•é€šè¿‡æ”¹å˜ p3 å½±å“ p1ï¼ŒæˆåŠŸäº†ï¼Œè€Œé€šè¿‡æ”¹å˜ p4 å½±å“ p2 å¤±è´¥äº†ã€‚
 * åŸå› æ˜¯ p2 é€šè¿‡è®¾ç½® canReferenced å±æ€§æ‹’ç»äº†è¢«å¼•ç”¨ä¼ é€’ã€‚
 */</span></code></pre><p data-reactid="114"><!-- react-text: 115 -->å‘ï¼ä¸€ä¸ªç®€å•çš„å¼•ç”¨ä¼ é€’å°±å®ç°äº†ã€‚çœ‹èµ·æ¥å¾ˆä¸å®‰å…¨ï¼Œä½†æ˜¯éå¸¸æœ‰è¶£ä¸æ˜¯ä¹ˆï¼ŸğŸ˜‰<!-- /react-text --></p><h1 data-reactid="116"><!-- react-text: 117 -->å®Œ<!-- /react-text --></h1></article></div><div data-reactid="118"><div class="blog-star" data-reactid="119"><iframe src="https://ghbtns.com/github-btn.html?user=jazzysnail&amp;repo=blog&amp;type=star&amp;count=true&amp;size=small" scrolling="0" data-reactid="120"></iframe></div></div><div class="post-footer" data-reactid="121"><div class="post-footer-line" data-reactid="122"></div><a class="previous" href="posts/My-understanding-on-closures" data-reactid="123"><i class="mineicon mineicon-arrowleft" data-reactid="124"></i><!-- react-text: 125 -->Â <!-- /react-text --><span class="label" data-reactid="126">prev</span><span class="post-title" data-reactid="127">å…³äºé—­åŒ…ä¹‹æˆ‘è§</span></a><div class="comment-tip" data-reactid="128"><span data-reactid="129">âŒ˜ + enter post comment</span></div><a class="next" href="posts/ES-new" data-reactid="130"><span class="post-title" data-reactid="131">New</span><span class="label" data-reactid="132">next</span><!-- react-text: 133 -->Â <!-- /react-text --><i class="mineicon mineicon-arrowright" data-reactid="134"></i></a></div></div></div><footer data-reactid="135"><span class="linkup" data-reactid="136"><a href="http://github.com/jazzysnail" target="_blank" data-reactid="137"><i class="mineicon mineicon-github" data-reactid="138"></i></a><a href="http://2017.zcool.com.cn/u/2061043" target="_blank" data-reactid="139"><i class="mineicon mineicon-zcool" data-reactid="140"></i></a></span><p data-reactid="141"><!-- react-text: 142 -->All Content Copyright Â© <!-- /react-text --><!-- react-text: 143 -->2016<!-- /react-text --><!-- react-text: 144 -->-<!-- /react-text --><!-- react-text: 145 -->2017<!-- /react-text --><!-- react-text: 146 --> leonâ€™s blog<!-- /react-text --></p><p style="color:#ccc;" data-reactid="147"><!-- react-text: 148 -->Powered by <!-- /react-text --><a href="https://github.com/benjycui/bisheng" target="_blank" data-reactid="149">Bisheng</a></p></footer></div></div>
  </body>
  <script src="/common.js"></script>
  <script src="/index.js"></script>
</html>